{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\roger\\\\Documents\\\\MeusProjetos\\\\projetotcc\\\\idoe-marketplace\\\\frontend\\\\src\\\\components\\\\Pages\\\\AnnouncementDetailPage.js\",\n  _s = $RefreshSig$();\n// frontend/src/components/Pages/AnnouncementDetailPage.js\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../../context/AuthContext';\nimport './AnnouncementDetailPage.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction AnnouncementDetailPage() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    id\n  } = useParams(); // Pega o ID da URL, ex: /anuncios/3 -> id = 3\n  const {\n    token,\n    user\n  } = useAuth(); // Pega o usuário logado do nosso contexto\n  const [anuncio, setAnuncio] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const handleDelete = async () => {\n    if (!window.confirm('Tem certeza que deseja deletar este anúncio? Esta ação é irreversível.')) {\n      return;\n    }\n    try {\n      const response = await fetch(`http://localhost:5000/api/anuncios/${id}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': token // Envia o token para autorização\n        }\n      });\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.message || 'Falha ao deletar.');\n      }\n      navigate('/anuncios'); // Redireciona após o sucesso\n    } catch (err) {\n      setError(err.message);\n    }\n  };\n  useEffect(() => {\n    const fetchAnuncio = async () => {\n      try {\n        const response = await fetch(`http://localhost:5000/api/anuncios/${id}`);\n        if (!response.ok) {\n          throw new Error('Anúncio não encontrado.');\n        }\n        const data = await response.json();\n        setAnuncio(data);\n      } catch (err) {\n        setError(err.message);\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchAnuncio();\n  }, [id]); // O useEffect roda novamente se o ID na URL mudar\n\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Carregando...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 23\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"error-message\",\n    children: [\"Erro: \", error]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 21\n  }, this);\n  if (!anuncio) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"An\\xFAncio n\\xE3o encontrado.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 24\n  }, this);\n\n  // Verifica se o usuário logado é o dono do anúncio\n  const isOwner = user && user.subject === anuncio.user_id;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"detail-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n      src: anuncio.image_url,\n      alt: anuncio.title,\n      className: \"detail-image\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"detail-content\",\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"detail-title\",\n        children: anuncio.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"detail-donor\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Doador(a):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 37\n        }, this), \" \", anuncio.donor_name]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"detail-location\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Localidade:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 68,\n          columnNumber: 40\n        }, this), \" \", anuncio.location]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"detail-date\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Publicado em:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), \" \", new Date(anuncio.creation_date).toLocaleDateString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), anuncio.expiration_date && /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"detail-date\",\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"V\\xE1lido at\\xE9:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 13\n        }, this), \" \", new Date(anuncio.expiration_date).toLocaleDateString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 11\n      }, this), !isOwner && /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"chat-button\",\n        children: \"Conversar com Doador(a)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 22\n      }, this), isOwner && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleDelete,\n        className: \"delete-button\",\n        children: \"Deletar An\\xFAncio\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n}\n_s(AnnouncementDetailPage, \"SQn+qOT0kBb0TM13ol8x6zZF31k=\", false, function () {\n  return [useNavigate, useParams, useAuth];\n});\n_c = AnnouncementDetailPage;\nexport default AnnouncementDetailPage;\nvar _c;\n$RefreshReg$(_c, \"AnnouncementDetailPage\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useAuth","jsxDEV","_jsxDEV","AnnouncementDetailPage","_s","navigate","id","token","user","anuncio","setAnuncio","loading","setLoading","error","setError","handleDelete","window","confirm","response","fetch","method","headers","ok","data","json","Error","message","err","fetchAnuncio","children","fileName","_jsxFileName","lineNumber","columnNumber","className","isOwner","subject","user_id","src","image_url","alt","title","donor_name","location","Date","creation_date","toLocaleDateString","expiration_date","onClick","_c","$RefreshReg$"],"sources":["C:/Users/roger/Documents/MeusProjetos/projetotcc/idoe-marketplace/frontend/src/components/Pages/AnnouncementDetailPage.js"],"sourcesContent":["// frontend/src/components/Pages/AnnouncementDetailPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate  } from 'react-router-dom';\r\nimport { useAuth } from '../../context/AuthContext';\r\nimport './AnnouncementDetailPage.css';\r\n\r\nfunction AnnouncementDetailPage() {\r\n  const navigate = useNavigate();\r\n  const { id } = useParams(); // Pega o ID da URL, ex: /anuncios/3 -> id = 3\r\n  const { token, user } = useAuth(); // Pega o usuário logado do nosso contexto\r\n  const [anuncio, setAnuncio] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n\r\n   const handleDelete = async () => {\r\n    if (!window.confirm('Tem certeza que deseja deletar este anúncio? Esta ação é irreversível.')) {\r\n      return;\r\n    }\r\n    try {\r\n      const response = await fetch(`http://localhost:5000/api/anuncios/${id}`, {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Authorization': token // Envia o token para autorização\r\n        }\r\n      });\r\n      if (!response.ok) {\r\n        const data = await response.json();\r\n        throw new Error(data.message || 'Falha ao deletar.');\r\n      }\r\n      navigate('/anuncios'); // Redireciona após o sucesso\r\n    } catch (err) {\r\n      setError(err.message);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const fetchAnuncio = async () => {\r\n      try {\r\n        const response = await fetch(`http://localhost:5000/api/anuncios/${id}`);\r\n        if (!response.ok) {\r\n          throw new Error('Anúncio não encontrado.');\r\n        }\r\n        const data = await response.json();\r\n        setAnuncio(data);\r\n      } catch (err) {\r\n        setError(err.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchAnuncio();\r\n  }, [id]); // O useEffect roda novamente se o ID na URL mudar\r\n\r\n  if (loading) return <p>Carregando...</p>;\r\n  if (error) return <p className=\"error-message\">Erro: {error}</p>;\r\n  if (!anuncio) return <p>Anúncio não encontrado.</p>;\r\n\r\n  // Verifica se o usuário logado é o dono do anúncio\r\n  const isOwner = user && user.subject === anuncio.user_id;\r\n\r\n  return (\r\n    <div className=\"detail-container\">\r\n      <img src={anuncio.image_url} alt={anuncio.title} className=\"detail-image\" />\r\n      <div className=\"detail-content\">\r\n        <h1 className=\"detail-title\">{anuncio.title}</h1>\r\n        <p className=\"detail-donor\"><strong>Doador(a):</strong> {anuncio.donor_name}</p>\r\n        <p className=\"detail-location\"><strong>Localidade:</strong> {anuncio.location}</p>\r\n        <p className=\"detail-date\">\r\n          <strong>Publicado em:</strong> {new Date(anuncio.creation_date).toLocaleDateString()}\r\n        </p>\r\n        {anuncio.expiration_date && (\r\n          <p className=\"detail-date\">\r\n            <strong>Válido até:</strong> {new Date(anuncio.expiration_date).toLocaleDateString()}\r\n          </p>\r\n        )}\r\n\r\n        {/* O botão de Chat aparecerá para todos (exceto o dono) */}\r\n        {!isOwner && <button className=\"chat-button\">Conversar com Doador(a)</button>}\r\n\r\n        {/* O botão de Deletar SÓ aparece se o usuário logado for o dono */}\r\n        {isOwner && <button onClick={handleDelete} className=\"delete-button\">Deletar Anúncio</button>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AnnouncementDetailPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}